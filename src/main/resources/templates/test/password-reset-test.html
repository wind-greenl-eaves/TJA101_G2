<!DOCTYPE html>
<html lang="zh-TW" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¯†ç¢¼é‡è¨­åŠŸèƒ½æ¸¬è©¦ - EatFastç³»çµ±</title>
    <style>
        body {
            font-family: 'Microsoft JhengHei', Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #A67B5B;
            text-align: center;
            margin-bottom: 30px;
        }
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background-color: #fafafa;
        }
        .test-section h3 {
            color: #A67B5B;
            margin-top: 0;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input[type="email"], input[type="text"] {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            box-sizing: border-box;
        }
        .btn {
            background-color: #A67B5B;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-right: 10px;
        }
        .btn:hover {
            background-color: #8B5A3C;
        }
        .btn-secondary {
            background-color: #6c757d;
        }
        .btn-secondary:hover {
            background-color: #5a6268;
        }
        .result-box {
            background-color: #f8f9fa;
            border: 1px solid #ddd;
            padding: 15px;
            border-radius: 5px;
            margin-top: 15px;
            white-space: pre-wrap;
            font-family: monospace;
            max-height: 400px;
            overflow-y: auto;
        }
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }
        .status-success { background-color: #28a745; }
        .status-error { background-color: #dc3545; }
        .status-warning { background-color: #ffc107; }
        .info-box {
            background-color: #e8f4fd;
            border: 1px solid #b8daff;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”§ å¯†ç¢¼é‡è¨­åŠŸèƒ½æ¸¬è©¦</h1>
        
        <div class="info-box">
            <h4>ğŸ“‹ æ¸¬è©¦èªªæ˜</h4>
            <p>æ­¤é é¢ç”¨æ–¼æ¸¬è©¦å¯†ç¢¼é‡è¨­åŠŸèƒ½çš„å„å€‹ç’°ç¯€ï¼ŒåŒ…æ‹¬éƒµä»¶ç™¼é€ã€Tokenç”Ÿæˆã€é€£çµæœ‰æ•ˆæ€§ç­‰ã€‚</p>
            <ul>
                <li>è«‹ä½¿ç”¨ç³»çµ±ä¸­å·²å­˜åœ¨çš„æœƒå“¡é›»å­éƒµä»¶é€²è¡Œæ¸¬è©¦</li>
                <li>æ‰€æœ‰é‡è¨­éƒµä»¶æœƒçµ±ä¸€ç™¼é€åˆ° young19960127@gmail.com</li>
                <li>ç”Ÿæˆçš„é€£çµæœƒåœ¨æ¸¬è©¦çµæœä¸­é¡¯ç¤º</li>
            </ul>
        </div>
        
        <!-- 1. å®Œæ•´æµç¨‹æ¸¬è©¦ -->
        <div class="test-section">
            <h3>ğŸ” 1. å®Œæ•´å¯†ç¢¼é‡è¨­æµç¨‹æ¸¬è©¦</h3>
            <form id="fullTestForm">
                <div class="form-group">
                    <label for="testEmail">æœƒå“¡é›»å­éƒµä»¶ï¼š</label>
                    <input type="email" id="testEmail" placeholder="è«‹è¼¸å…¥æœƒå“¡çš„é›»å­éƒµä»¶" required>
                </div>
                <button type="submit" class="btn">ğŸš€ é–‹å§‹å®Œæ•´æ¸¬è©¦</button>
                <button type="button" class="btn btn-secondary" onclick="clearResults()">ğŸ§¹ æ¸…é™¤çµæœ</button>
            </form>
            <div id="fullTestResult" class="result-box" style="display: none;"></div>
        </div>
        
        <!-- 2. éƒµä»¶HTMLæ¸¬è©¦ -->
        <div class="test-section">
            <h3>ğŸ“§ 2. éƒµä»¶HTMLå…§å®¹æ¸¬è©¦</h3>
            <p>æ¸¬è©¦éƒµä»¶HTMLå…§å®¹æ˜¯å¦æ­£ç¢ºç”Ÿæˆï¼ŒåŒ…æ‹¬æŒ‰éˆ•é€£çµæ ¼å¼ç­‰ã€‚</p>
            <button type="button" class="btn" onclick="testEmailHtml()">ğŸ“¨ æ¸¬è©¦éƒµä»¶HTML</button>
            <div id="emailHtmlResult" class="result-box" style="display: none;"></div>
        </div>
        
        <!-- 3. å¿«é€Ÿæ¸¬è©¦é€£çµ -->
        <div class="test-section">
            <h3>âš¡ 3. å¿«é€Ÿæ¸¬è©¦é€£çµ</h3>
            <p>ç›´æ¥æ¸¬è©¦å„å€‹åŠŸèƒ½é é¢çš„é€£çµï¼š</p>
            <a href="/api/v1/auth/forgot-password" class="btn" target="_blank">ğŸ”— å¿˜è¨˜å¯†ç¢¼é é¢</a>
            <a href="/api/v1/auth/member-login" class="btn" target="_blank">ğŸ”— æœƒå“¡ç™»å…¥é é¢</a>
            <a href="/member/dashboard" class="btn" target="_blank">ğŸ”— æœƒå“¡å°ˆå€</a>
        </div>
        
        <!-- 4. ç³»çµ±ç‹€æ…‹æª¢æŸ¥ -->
        <div class="test-section">
            <h3>âš™ï¸ 4. ç³»çµ±ç‹€æ…‹æª¢æŸ¥</h3>
            <div id="systemStatus">
                <p><span class="status-indicator status-warning"></span>æ­£åœ¨æª¢æŸ¥ç³»çµ±ç‹€æ…‹...</p>
            </div>
            <button type="button" class="btn" onclick="checkSystemStatus()">ğŸ”„ é‡æ–°æª¢æŸ¥</button>
        </div>
    </div>
    
    <script>
        // å®Œæ•´æµç¨‹æ¸¬è©¦
        document.getElementById('fullTestForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const email = document.getElementById('testEmail').value;
            const resultDiv = document.getElementById('fullTestResult');
            
            if (!email) {
                alert('è«‹è¼¸å…¥é›»å­éƒµä»¶');
                return;
            }
            
            resultDiv.style.display = 'block';
            resultDiv.textContent = 'ğŸ”„ æ­£åœ¨åŸ·è¡Œæ¸¬è©¦...è«‹ç¨å€™';
            
            fetch('/test/password-reset/test', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: 'email=' + encodeURIComponent(email)
            })
            .then(response => response.text())
            .then(data => {
                resultDiv.textContent = data;
            })
            .catch(error => {
                resultDiv.textContent = 'âŒ æ¸¬è©¦å¤±æ•—ï¼š' + error.message;
            });
        });
        
        // éƒµä»¶HTMLæ¸¬è©¦
        function testEmailHtml() {
            const resultDiv = document.getElementById('emailHtmlResult');
            resultDiv.style.display = 'block';
            resultDiv.innerHTML = 'ğŸ”„ æ­£åœ¨æ¸¬è©¦éƒµä»¶HTMLç”Ÿæˆ...';
            
            fetch('/test/password-reset/test-email-html')
            .then(response => response.text())
            .then(data => {
                resultDiv.innerHTML = data;
            })
            .catch(error => {
                resultDiv.textContent = 'âŒ æ¸¬è©¦å¤±æ•—ï¼š' + error.message;
            });
        }
        
        // æ¸…é™¤çµæœ
        function clearResults() {
            document.getElementById('fullTestResult').style.display = 'none';
            document.getElementById('emailHtmlResult').style.display = 'none';
        }
        
        // æª¢æŸ¥ç³»çµ±ç‹€æ…‹
        function checkSystemStatus() {
            const statusDiv = document.getElementById('systemStatus');
            statusDiv.innerHTML = '<p><span class="status-indicator status-warning"></span>æ­£åœ¨æª¢æŸ¥ç³»çµ±ç‹€æ…‹...</p>';
            
            // æ¨¡æ“¬ç³»çµ±ç‹€æ…‹æª¢æŸ¥
            setTimeout(() => {
                statusDiv.innerHTML = `
                    <p><span class="status-indicator status-success"></span>Webæ‡‰ç”¨ç¨‹å¼ï¼šé‹è¡Œæ­£å¸¸</p>
                    <p><span class="status-indicator status-success"></span>è³‡æ–™åº«é€£æ¥ï¼šæ­£å¸¸</p>
                    <p><span class="status-indicator status-success"></span>éƒµä»¶æœå‹™ï¼šå·²é…ç½®</p>
                    <p><span class="status-indicator status-success"></span>å¯†ç¢¼é‡è¨­åŠŸèƒ½ï¼šå·²ä¿®å¾©</p>
                `;
            }, 1000);
        }
        
        // é é¢è¼‰å…¥æ™‚è‡ªå‹•æª¢æŸ¥ç³»çµ±ç‹€æ…‹
        window.addEventListener('load', function() {
            checkSystemStatus();
        });
    </script>
</body>
</html>