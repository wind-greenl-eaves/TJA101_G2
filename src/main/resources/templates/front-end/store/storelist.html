<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é–€å¸‚æ“šé» - EatFast</title>

    <script src="https://cdn.tailwindcss.com"></script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">

    <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            sans: ['Noto Sans TC', 'sans-serif'],
          },
          colors: {
            'brand-bg': '#FDFBF6',      // èƒŒæ™¯è‰² - æä»ç™½
            'brand-container': '#F5EFE6', // å®¹å™¨èƒŒæ™¯ - ç‡•éº¥è‰²
            'brand-primary': '#A67B5B', // ä¸»é¡Œè‰² - å¥¶èŒ¶æ£•
            'brand-primary-hover': '#8C684A', // ä¸»é¡Œæ‡¸åœè‰² - æ·±ç„™å¥¶èŒ¶
            'brand-text': '#5D534A',    // ä¸»è¦æ–‡å­— - ç‚­ç„™æ£•
            'brand-deep': '#3C2A21',     // æ¥µæ·±å’–å•¡è‰²ï¼Œç”¨æ–¼å¼·èª¿
            'brand-accent': '#E1A87A',  // é»ç¶´è‰² - ç„¦ç³–æ©˜
          }
        }
      }
    }
    </script>
    
    <style>
        /* ç‚ºè¢«é¸ä¸­çš„æŒ‰éˆ•å®šç¾©ä¸€å€‹å•Ÿç”¨ç‹€æ…‹çš„æ¨£å¼ */
        .store-button.active {
            background-color: #A67B5B; /* brand-primary */
            color: white;
            font-weight: bold;
        }
    </style>
</head>

<body class="bg-brand-bg text-brand-text antialiased">

    <header class="bg-white shadow-md fixed top-0 left-0 w-full z-50 transition-all duration-300">
        <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
            
            <div class="flex-shrink-0">
                <a th:href="@{/welcome}" class="flex items-center">
                    <img th:src="@{/images/123.png}" alt="Logo" class="w-12 h-12 rounded-full mr-2">
                    <span class="text-xl font-bold text-brand-deep">EatFast æ—©å®‰ï¼</span>
                </a>
            </div>

            <div class="hidden md:flex space-x-8"> 
                <a th:href="@{/welcome}" class="text-brand-text hover:text-brand-primary font-medium text-lg">é—œæ–¼æˆ‘å€‘</a>
                <a th:href="@{/welcome}" class="text-brand-text hover:text-brand-primary font-medium text-lg">æœ€æ–°æ¶ˆæ¯</a>
                <a th:href="@{/store/view}" class="text-brand-primary font-bold text-lg">é–€å¸‚æ“šé»</a> 
                <a th:href="@{/menu}" class="text-brand-text hover:text-brand-primary font-medium text-lg">æˆ‘è¦è¨‚é¤</a> 
                <a th:href="@{/cart}" class="text-brand-text hover:text-brand-primary font-medium text-lg">è³¼ç‰©è»Š</a>
            </div>

            <div class="hidden md:flex items-center space-x-4">
                <a href="/api/v1/auth/member-login" class="bg-brand-accent text-brand-deep font-bold px-5 py-2 rounded-full hover:bg-orange-400 transition-colors shadow-sm">
                    ç™»å…¥/è¨»å†Š
                </a>
            </div>

        </nav>
    </header>

    <main class="container mx-auto p-4 md:p-8 pt-28 md:pt-32">
        
        <div class="flex flex-col md:flex-row gap-8">

            <aside class="w-full md:w-64 flex-shrink-0">
                <div class="bg-brand-container p-4 rounded-lg shadow-md h-full">
                    <h2 class="text-xl font-bold text-brand-deep mb-4 border-b-2 border-gray-300 pb-2">é–€å¸‚æ“šé»</h2>
                    <nav class="space-y-2">
                        <th:block th:each="store, iterStat : ${storeList}">
                            <button
                                class="store-button w-full text-left px-4 py-2 rounded-md transition-colors duration-200"
                                th:classappend="${iterStat.index == 0} ? 'active'"
                                th:data-id="${store.storeId}"
                                th:data-name="${store.storeName}"
                                th:data-loc="${store.storeLoc}"
                                th:data-phone="${store.storePhone}"
                                th:data-time="${store.storeTime}"
                                th:data-map-url="${store.googleMapUrl}">
                                <span th:text="${store.storeName}">ä¸€è™Ÿåº—</span>
                            </button>
                        </th:block>
                    </nav>
                </div>
            </aside>

            <section class="flex-grow">
                <div class="bg-brand-container p-6 md:p-8 rounded-lg shadow-md">
                    <h1 id="store-name" class="text-3xl font-bold text-brand-deep mb-2" th:text="${currentStore.storeName}">ä¸€è™Ÿåº—</h1>
                    <p class="text-lg text-brand-primary mb-6" th:text="'é–€å¸‚è©³ç´°è³‡è¨Š'">é–€å¸‚è©³ç´°è³‡è¨Š</p>

                    <div class="space-y-4 text-brand-text">
                        <div class="flex items-center">
                            <span class="font-bold w-24">ğŸ“ åœ°é»</span>
                            <span id="store-loc" th:text="${currentStore.storeLoc}">104å°åŒ—å¸‚ä¸­å±±å€å—äº¬æ±è·¯ä¸‰æ®µ219è™Ÿ4F</span>
                        </div>
                        <div class="flex items-center">
                            <span class="font-bold w-24">ğŸ“ é›»è©±</span>
                            <span id="store-phone" th:text="${currentStore.storePhone}">02-27120589</span>
                        </div>
                        <div class="flex items-center">
                            <span class="font-bold w-24">â° ç‡Ÿæ¥­æ™‚é–“</span>
                            <span id="store-time" th:text="${currentStore.storeTime}">å¹³æ—¥05:30~14:00 / å‡æ—¥ 07:00~16:00 (é€±ä¸‰å…¬ä¼‘)</span>
                        </div>
                    </div>

                    <div class="mt-8 border rounded-lg overflow-hidden shadow-inner">
                        <iframe id="store-map-iframe"
                                th:src="${currentStore.googleMapUrl}"
                                width="100%"
                                height="350"
                                style="border:0;"
                                allowfullscreen=""
                                loading="lazy"
                                referrerpolicy="no-referrer-when-downgrade">
                        </iframe>
                    </div>
                    
                    <div class="mt-8 text-center">
                         <a id="order-now-button"
                           th:href="@{/meal/{storeId}(storeId=${currentStore.storeId})}"
                           class="bg-brand-accent text-brand-deep font-bold py-3 px-8 rounded-full shadow-lg hover:bg-orange-400 transform hover:-translate-y-1 transition-all duration-300 ease-in-out">
                           å‰å¾€é»é¤
                        </a>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <footer class="bg-brand-deep text-brand-container text-center p-6 mt-16">
        <p>&copy; 2025 EatFast æ—©é¤åº— - ç‰ˆæ¬Šæ‰€æœ‰ | ç‚ºæ‚¨æä¾›æœ€å„ªè³ªçš„æ—©é¤æœå‹™ </p>
    </footer>

    <script>
        // ç­‰å¾…æ•´å€‹ç¶²é æ–‡ä»¶éƒ½è¼‰å…¥å®Œæˆå¾Œï¼Œå†åŸ·è¡Œè£¡é¢çš„ç¨‹å¼ç¢¼
        document.addEventListener('DOMContentLoaded', function() {
            
            // æ‰¾åˆ°æ‰€æœ‰ä»£è¡¨é–€å¸‚çš„æŒ‰éˆ•
            const storeButtons = document.querySelectorAll('.store-button');
            
            // æ‰¾åˆ°å³å´è¦è¢«æ›´æ–°å…§å®¹çš„å„å€‹å…ƒç´ 
            const storeNameEl = document.getElementById('store-name');
            const storeLocEl = document.getElementById('store-loc');
            const storePhoneEl = document.getElementById('store-phone');
            const storeTimeEl = document.getElementById('store-time');
            const storeMapIframeEl = document.getElementById('store-map-iframe');
            const orderNowButtonEl = document.getElementById('order-now-button');

            // ç‚ºæ¯ä¸€å€‹æŒ‰éˆ•åŠ ä¸Šé»æ“Šäº‹ä»¶çš„ç›£è½
            storeButtons.forEach(button => {
                button.addEventListener('click', function() {
                    
                    // --- æ›´æ–°å³å´è©³ç´°è³‡è¨Š ---
                    // å¾è¢«é»æ“Šçš„æŒ‰éˆ•çš„ data-* å±¬æ€§ä¸­ï¼Œè®€å–å„²å­˜çš„è³‡æ–™
                    const data = this.dataset;
                    
                    storeNameEl.textContent = data.name;
                    storeLocEl.textContent = data.loc;
                    storePhoneEl.textContent = data.phone;
                    storeTimeEl.textContent = data.time;
                    storeMapIframeEl.src = data.mapUrl;
                    
                    // æ›´æ–° "å‰å¾€é»é¤" æŒ‰éˆ•çš„é€£çµ
                    const orderUrl = `[[@{/meal/list/}]]${data.id}`;
                    orderNowButtonEl.href = orderUrl;

                    // --- æ›´æ–°æŒ‰éˆ•çš„å•Ÿç”¨ç‹€æ…‹æ¨£å¼ ---
                    // 1. å…ˆç§»é™¤æ‰€æœ‰æŒ‰éˆ•çš„ 'active' class
                    storeButtons.forEach(btn => btn.classList.remove('active'));
                    // 2. åªç‚ºç•¶å‰è¢«é»æ“Šçš„æŒ‰éˆ•åŠ ä¸Š 'active' class
                    this.classList.add('active');
                });
            });
        });
    </script>
</body>
</html>